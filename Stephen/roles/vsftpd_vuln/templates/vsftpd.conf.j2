# vsftpd Vulnerable Configuration Template
# This file intentionally misconfigures the FTP service

# standalone and listener options
listen={{ 'YES' if ansible_facts['os_family'] == 'Debian' else 'NO' }}
listen_ipv6=NO

# anonymous access vulnerability
anonymous_enable={{ ftp_anonymous_enable | default('YES') }}
anon_root={{ ftp_root_dir }}/public
no_anon_password=YES
anon_upload_enable=YES
anon_mkdir_write_enable=YES
anon_other_write_enable=YES

# local user access
# Allows attackers who find leaked credentials to pivot to an SSH-capable user.
local_enable=YES
write_enable=YES
local_umask=022

# security weakness
# Intentionally disabling chroot allows an attacker to leave the FTP directory
chroot_local_user=YES
allow_writeable_chroot=YES

# logging
xferlog_enable=YES
connect_from_port_20=YES
ftpd_banner=Welcome to the Corporate Testing FTP Server. Unauthorized access is prohibited.

# other config for port security
pasv_min_port=40000
pasv_max_port=40100

# define the root for anonymous users
anon_root={{ ftp_root_dir }}